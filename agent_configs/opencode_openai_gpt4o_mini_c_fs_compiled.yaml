extends: opencode_grok4fast_c_fs_v2.yaml

profile: { name: opencode-openai-gpt4o-mini-c-fs }

prompts:
  tool_prompt_mode: system_compiled_and_persistent_per_turn

providers:
  default_model: openai/gpt-4o-mini
  models:
    - id: openai/gpt-4o-mini
      adapter: openai
      params: { temperature: 0.2, top_p: 0.9 }

# Prefer text-based tool prompts/dialects for this smoke test
provider_tools:
  use_native: true
  suppress_prompts: false

enhanced_tools:
  enabled: true
  validation:
    enabled: true
    rules: [one_bash_per_turn]
    rule_config:
      one_bash_per_turn: { turn_window_seconds: 120 }

prompts:
  tool_prompt_mode: system_compiled_and_persistent_per_turn
  tool_prompt_synthesis:
    enabled: true
    dialects:
      pythonic:
        system_full: implementations/tool_prompt_synthesis/pythonic/system_full.j2.md
        per_turn_short: implementations/tool_prompt_synthesis/pythonic/per_turn_plan_strict.j2.md
      opencode_patch:
        system_full: implementations/tool_prompt_synthesis/opencode_patch/system_full.j2.md
        per_turn_short: implementations/tool_prompt_synthesis/opencode_patch/per_turn_short.j2.md
    selection:
      by_mode:
        plan: pythonic
        build: opencode_patch
    detail:
      system: full
      per_turn: short
